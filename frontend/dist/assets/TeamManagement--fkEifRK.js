import{c as Z,r as a,j as e,d as f,B as t,I as y,D as de,e as oe,g as me,i as v,h as he,a as m}from"./index-Og0Cjv7c.js";import{R as xe}from"./index-CtgARJQr.js";import{L as h}from"./label-D4adTHT0.js";import{B as P}from"./badge-0u9PLDS-.js";import{C as je}from"./card-DKR6wQjg.js";import{T as pe,a as ue,b as N,c as r,d as ge,e as n}from"./table-BZ65fvGu.js";import{D as w,f as fe,a as C,b as D,c as S,d as b,e as k}from"./dialog-CL49OCni.js";import{A as V,b as z,S as G,c as J,d as K,e as Q,f as W}from"./select-Dr9AkgeC.js";import{C as X}from"./circle-alert-DC9QC6T-.js";import{L as ye}from"./loader-circle-qKgIXUvm.js";import{E as ve,T as Ne,a as we}from"./toggle-right-BHKK4ZKU.js";import{T as Ce}from"./trash-2-CFn0c5VE.js";import"./index-BdQq_4o_.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Se=Z("plus",De);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ke=Z("user-cog",be),Y=["viewer","operator","admin","super_admin"];function $e(){const[_,ee]=a.useState([]),[se,ae]=a.useState(!0),[T,u]=a.useState(!1),[R,E]=a.useState(""),[A,M]=a.useState(""),[L,O]=a.useState(""),[F,q]=a.useState("admin"),[g,U]=a.useState(!1),[x,l]=a.useState(""),[te,j]=a.useState(!1),[i,B]=a.useState(null),[I,$]=a.useState(""),[ne,p]=a.useState(!1),[c,H]=a.useState(null);async function d(){try{const s=await m.get("/api/admin/team");ee(s.admins)}finally{ae(!1)}}async function re(s){s.preventDefault(),U(!0),l("");try{await m.post("/api/admin/team",{username:R,password:A,display_name:L||null,role:F}),E(""),M(""),O(""),q("admin"),u(!1),d()}catch(o){l(o instanceof Error?o.message:"Failed to create")}finally{U(!1)}}async function le(){if(i)try{await m.patch(`/api/admin/team/${i.id}`,{role:I}),j(!1),B(null),d()}catch(s){l(s instanceof Error?s.message:"Failed to update")}}async function ie(s){try{await m.patch(`/api/admin/team/${s.id}`,{is_active:!s.is_active}),d()}catch(o){l(o instanceof Error?o.message:"Failed to update")}}async function ce(){if(c)try{await m.delete(`/api/admin/team/${c.id}`),p(!1),H(null),d()}catch(s){l(s instanceof Error?s.message:"Failed to delete")}}return a.useEffect(()=>{d()},[]),se?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{className:"h-8 w-56"}),e.jsx(f,{className:"h-4 w-72"})]}),e.jsx(f,{className:"h-64 rounded-xl"})]}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Team Management"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage admin users and their roles"})]}),e.jsxs(w,{open:T,onOpenChange:u,children:[e.jsx(fe,{asChild:!0,children:e.jsxs(t,{children:[e.jsx(Se,{className:"h-4 w-4"}),"Add Member"]})}),e.jsxs(C,{children:[e.jsxs(D,{children:[e.jsx(S,{children:"Add Team Member"}),e.jsx(b,{children:"Create a new admin account with the specified role."})]}),e.jsxs("form",{onSubmit:re,className:"space-y-4",children:[x&&e.jsxs(V,{variant:"destructive",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx(z,{children:x})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"username",children:"Username"}),e.jsx(y,{id:"username",placeholder:"Username",value:R,onChange:s=>E(s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"password",children:"Password"}),e.jsx(y,{id:"password",type:"password",placeholder:"Password",value:A,onChange:s=>M(s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"displayName",children:"Display Name"}),e.jsx(y,{id:"displayName",placeholder:"Display Name (optional)",value:L,onChange:s=>O(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Role"}),e.jsxs(G,{value:F,onValueChange:q,children:[e.jsx(J,{children:e.jsx(K,{})}),e.jsx(Q,{children:Y.map(s=>e.jsx(W,{value:s,children:s.replace("_"," ")},s))})]})]}),e.jsxs(k,{children:[e.jsx(t,{type:"button",variant:"outline",onClick:()=>u(!1),children:"Cancel"}),e.jsxs(t,{type:"submit",disabled:g,children:[g&&e.jsx(ye,{className:"animate-spin"}),g?"Creating...":"Add Member"]})]})]})]})]})]}),x&&!T&&e.jsxs(V,{variant:"destructive",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx(z,{children:x})]}),e.jsx(je,{children:e.jsxs(pe,{children:[e.jsx(ue,{children:e.jsxs(N,{children:[e.jsx(r,{children:"Username"}),e.jsx(r,{children:"Display Name"}),e.jsx(r,{children:"Role"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Last Login"}),e.jsx(r,{className:"w-12"})]})}),e.jsxs(ge,{children:[_.map(s=>e.jsxs(N,{children:[e.jsx(n,{className:"font-medium",children:s.username}),e.jsx(n,{className:"text-muted-foreground",children:s.display_name||"â€”"}),e.jsx(n,{children:e.jsx(P,{variant:"secondary",className:`capitalize ${xe[s.role||"viewer"]||""}`,children:(s.role||"viewer").replace("_"," ")})}),e.jsx(n,{children:e.jsx(P,{variant:"secondary",className:s.is_active?"bg-emerald-100 text-emerald-700":"bg-red-100 text-red-700",children:s.is_active?"Active":"Disabled"})}),e.jsx(n,{className:"text-muted-foreground text-sm",children:s.last_login_at?new Date(s.last_login_at).toLocaleString():"Never"}),e.jsx(n,{children:e.jsxs(de,{children:[e.jsx(oe,{asChild:!0,children:e.jsx(t,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(ve,{className:"h-4 w-4"})})}),e.jsxs(me,{align:"end",children:[e.jsxs(v,{onClick:()=>{B(s),$(s.role||"viewer"),j(!0)},children:[e.jsx(ke,{className:"h-4 w-4"}),"Change Role"]}),e.jsxs(v,{onClick:()=>ie(s),children:[s.is_active?e.jsx(Ne,{className:"h-4 w-4"}):e.jsx(we,{className:"h-4 w-4"}),s.is_active?"Disable":"Enable"]}),e.jsx(he,{}),e.jsxs(v,{className:"text-destructive focus:text-destructive",onClick:()=>{H(s),p(!0)},children:[e.jsx(Ce,{className:"h-4 w-4"}),"Delete"]})]})]})})]},s.id)),_.length===0&&e.jsx(N,{children:e.jsx(n,{colSpan:6,className:"h-24 text-center text-muted-foreground",children:"No team members found"})})]})]})}),e.jsx(w,{open:te,onOpenChange:j,children:e.jsxs(C,{children:[e.jsxs(D,{children:[e.jsx(S,{children:"Change Role"}),e.jsxs(b,{children:["Update the role for"," ",e.jsx("span",{className:"font-medium text-foreground",children:i==null?void 0:i.username}),"."]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"New Role"}),e.jsxs(G,{value:I,onValueChange:$,children:[e.jsx(J,{children:e.jsx(K,{})}),e.jsx(Q,{children:Y.map(s=>e.jsx(W,{value:s,children:s.replace("_"," ")},s))})]})]}),e.jsxs(k,{children:[e.jsx(t,{variant:"outline",onClick:()=>j(!1),children:"Cancel"}),e.jsx(t,{onClick:le,children:"Save"})]})]})}),e.jsx(w,{open:ne,onOpenChange:p,children:e.jsxs(C,{children:[e.jsxs(D,{children:[e.jsx(S,{children:"Delete Admin"}),e.jsxs(b,{children:["Are you sure you want to delete"," ",e.jsxs("span",{className:"font-medium text-foreground",children:['"',c==null?void 0:c.username,'"']}),"? This action cannot be undone."]})]}),e.jsxs(k,{children:[e.jsx(t,{variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(t,{variant:"destructive",onClick:ce,children:"Delete"})]})]})})]})}export{$e as default};
