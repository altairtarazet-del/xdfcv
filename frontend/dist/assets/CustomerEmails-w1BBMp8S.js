import{w as $,r as a,j as e,d as t,B as A,L,a as n}from"./index-Og0Cjv7c.js";import{E as B}from"./EmailPanel-eEQInLYz.js";import{A as R}from"./triangle-alert-BALBCSHX.js";import"./card-DKR6wQjg.js";import"./index-BdQq_4o_.js";import"./badge-0u9PLDS-.js";import"./trash-2-CFn0c5VE.js";import"./mail-COINtWyb.js";import"./search-C1Z6BGo7.js";import"./loader-circle-qKgIXUvm.js";function H(){const{email:o}=$(),[f,p]=a.useState([]),[i,c]=a.useState(null),[g,d]=a.useState([]),[b,r]=a.useState(null),[j,m]=a.useState(!1),[N,x]=a.useState(!1),[y,w]=a.useState(""),[v,h]=a.useState(!0),[u,M]=a.useState("");async function S(){h(!0);try{const s=await n.get(`/api/admin/customer-emails/${encodeURIComponent(o)}/mailboxes`);if(p(s.mailboxes),s.mailboxes.length>0){const l=s.mailboxes.find(k=>k.name.toLowerCase()==="inbox")||s.mailboxes[0];c(l.id)}}catch(s){M(s instanceof Error?s.message:"Failed to load mailboxes")}finally{h(!1)}}async function C(s){m(!0),r(null);try{const l=await n.get(`/api/admin/customer-emails/${encodeURIComponent(o)}/mailboxes/${s}/messages?per_page=100`);d(l.data||[])}catch{d([])}finally{m(!1)}}async function E(s){if(i){x(!0);try{const l=await n.get(`/api/admin/customer-emails/${encodeURIComponent(o)}/mailboxes/${i}/messages/${s}`);r(l)}catch{r(null)}finally{x(!1)}}}return a.useEffect(()=>{S()},[o]),a.useEffect(()=>{i&&C(i)},[i]),u?e.jsx("div",{className:"p-8",children:e.jsx("div",{className:"bg-dd-red-lighter text-dd-red-active rounded-dd p-4 text-sm",children:u})}):v?e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-dd-200 bg-white flex-shrink-0 space-y-2",children:[e.jsx(t,{className:"h-4 w-32"}),e.jsx(t,{className:"h-6 w-48"})]}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsx("div",{className:"w-52 flex-shrink-0 border-r border-dd-200 p-3 space-y-2",children:Array.from({length:5}).map((s,l)=>e.jsx(t,{className:"h-4 w-full"},l))}),e.jsx("div",{className:"w-80 flex-shrink-0 border-r border-dd-200 p-3 space-y-3",children:Array.from({length:6}).map((s,l)=>e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(t,{className:"h-3 w-24"}),e.jsx(t,{className:"h-4 w-full"}),e.jsx(t,{className:"h-3 w-16"})]},l))}),e.jsxs("div",{className:"flex-1 p-5 space-y-4",children:[e.jsx(t,{className:"h-6 w-3/4"}),e.jsx(t,{className:"h-4 w-1/2"}),e.jsx(t,{className:"h-4 w-full"}),e.jsx(t,{className:"h-4 w-5/6"})]})]})]}):e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-dd-200 bg-white flex-shrink-0",children:[e.jsx(A,{variant:"link",asChild:!0,className:"p-0 h-auto text-primary",children:e.jsxs(L,{to:`/accounts/${encodeURIComponent(o)}`,children:[e.jsx(R,{className:"h-4 w-4"}),"Back to Account"]})}),e.jsxs("h1",{className:"text-xl font-bold text-dd-950 mt-1",children:["Emails: ",o]})]}),e.jsx(B,{mailboxes:f,activeMailbox:i,onSelectMailbox:c,messages:g,loadingMsgs:j,activeMessage:b,loadingBody:N,onSelectMessage:E,searchQuery:y,onSearchChange:w,onClearMessage:()=>r(null),attachmentBaseUrl:`/api/admin/customer-emails/${encodeURIComponent(o)}`})]})}export{H as default};
