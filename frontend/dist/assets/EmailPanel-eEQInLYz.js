import{c as H,r as a,j as t,k as Se,F as O,l as ve,P as Y,q as ge,p as A,O as R,G as je,v as T,a4 as oe,x as K,I as ye,y as Ne,B as te,d as g}from"./index-Og0Cjv7c.js";import{a as Ce,b as Pe}from"./card-DKR6wQjg.js";import{c as Ee}from"./index-BdQq_4o_.js";import{B as Re}from"./badge-0u9PLDS-.js";import{T as Te,A as Ae}from"./triangle-alert-BALBCSHX.js";import{T as _e}from"./trash-2-CFn0c5VE.js";import{M as G}from"./mail-COINtWyb.js";import{S as ke}from"./search-C1Z6BGo7.js";import{L as Le}from"./loader-circle-qKgIXUvm.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Oe=H("download",De);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ie=H("file-text",ze);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],He=H("paperclip",We);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Fe=H("pen-line",Be);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Ve=H("send",Ue);function Ye(e){const r=$e(e),n=a.forwardRef((s,l)=>{const{children:o,...c}=s,i=a.Children.toArray(o),d=i.find(qe);if(d){const h=d.props.children,f=i.map(p=>p===d?a.Children.count(h)>1?a.Children.only(null):a.isValidElement(h)?h.props.children:null:p);return t.jsx(r,{...c,ref:l,children:a.isValidElement(h)?a.cloneElement(h,void 0,f):null})}return t.jsx(r,{...c,ref:l,children:o})});return n.displayName=`${e}.Slot`,n}function $e(e){const r=a.forwardRef((n,s)=>{const{children:l,...o}=n;if(a.isValidElement(l)){const c=Ge(l),i=Ke(o,l.props);return l.type!==a.Fragment&&(i.ref=s?Se(s,c):c),a.cloneElement(l,i)}return a.Children.count(l)>1?a.Children.only(null):null});return r.displayName=`${e}.SlotClone`,r}var Xe=Symbol("radix.slottable");function qe(e){return a.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Xe}function Ke(e,r){const n={...r};for(const s in r){const l=e[s],o=r[s];/^on[A-Z]/.test(s)?l&&o?n[s]=(...i)=>{const d=o(...i);return l(...i),d}:l&&(n[s]=l):s==="style"?n[s]={...l,...o}:s==="className"&&(n[s]=[l,o].filter(Boolean).join(" "))}return{...e,...n}}function Ge(e){var s,l;let r=(s=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:s.get,n=r&&"isReactWarning"in r&&r.isReactWarning;return n?e.ref:(r=(l=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:l.get,n=r&&"isReactWarning"in r&&r.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Ze=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],B=Ze.reduce((e,r)=>{const n=Ye(`Primitive.${r}`),s=a.forwardRef((l,o)=>{const{asChild:c,...i}=l,d=c?n:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),t.jsx(d,{...i,ref:o})});return s.displayName=`Primitive.${r}`,{...e,[r]:s}},{});function Je(e,r){return a.useReducer((n,s)=>r[n][s]??n,e)}var Z="ScrollArea",[ne]=ge(Z),[Qe,j]=ne(Z),le=a.forwardRef((e,r)=>{const{__scopeScrollArea:n,type:s="hover",dir:l,scrollHideDelay:o=600,...c}=e,[i,d]=a.useState(null),[h,f]=a.useState(null),[p,m]=a.useState(null),[b,S]=a.useState(null),[P,z]=a.useState(null),[N,_]=a.useState(0),[I,k]=a.useState(0),[L,E]=a.useState(!1),[u,w]=a.useState(!1),x=O(r,y=>d(y)),v=ve(l);return t.jsx(Qe,{scope:n,type:s,dir:v,scrollHideDelay:o,scrollArea:i,viewport:h,onViewportChange:f,content:p,onContentChange:m,scrollbarX:b,onScrollbarXChange:S,scrollbarXEnabled:L,onScrollbarXEnabledChange:E,scrollbarY:P,onScrollbarYChange:z,scrollbarYEnabled:u,onScrollbarYEnabledChange:w,onCornerWidthChange:_,onCornerHeightChange:k,children:t.jsx(B.div,{dir:v,...c,ref:x,style:{position:"relative","--radix-scroll-area-corner-width":N+"px","--radix-scroll-area-corner-height":I+"px",...e.style}})})});le.displayName=Z;var se="ScrollAreaViewport",ae=a.forwardRef((e,r)=>{const{__scopeScrollArea:n,children:s,nonce:l,...o}=e,c=j(se,n),i=a.useRef(null),d=O(r,i,c.onViewportChange);return t.jsxs(t.Fragment,{children:[t.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:l}),t.jsx(B.div,{"data-radix-scroll-area-viewport":"",...o,ref:d,style:{overflowX:c.scrollbarXEnabled?"scroll":"hidden",overflowY:c.scrollbarYEnabled?"scroll":"hidden",...e.style},children:t.jsx("div",{ref:c.onContentChange,style:{minWidth:"100%",display:"table"},children:s})})]})});ae.displayName=se;var C="ScrollAreaScrollbar",J=a.forwardRef((e,r)=>{const{forceMount:n,...s}=e,l=j(C,e.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:c}=l,i=e.orientation==="horizontal";return a.useEffect(()=>(i?o(!0):c(!0),()=>{i?o(!1):c(!1)}),[i,o,c]),l.type==="hover"?t.jsx(Me,{...s,ref:r,forceMount:n}):l.type==="scroll"?t.jsx(et,{...s,ref:r,forceMount:n}):l.type==="auto"?t.jsx(ce,{...s,ref:r,forceMount:n}):l.type==="always"?t.jsx(Q,{...s,ref:r}):null});J.displayName=C;var Me=a.forwardRef((e,r)=>{const{forceMount:n,...s}=e,l=j(C,e.__scopeScrollArea),[o,c]=a.useState(!1);return a.useEffect(()=>{const i=l.scrollArea;let d=0;if(i){const h=()=>{window.clearTimeout(d),c(!0)},f=()=>{d=window.setTimeout(()=>c(!1),l.scrollHideDelay)};return i.addEventListener("pointerenter",h),i.addEventListener("pointerleave",f),()=>{window.clearTimeout(d),i.removeEventListener("pointerenter",h),i.removeEventListener("pointerleave",f)}}},[l.scrollArea,l.scrollHideDelay]),t.jsx(Y,{present:n||o,children:t.jsx(ce,{"data-state":o?"visible":"hidden",...s,ref:r})})}),et=a.forwardRef((e,r)=>{const{forceMount:n,...s}=e,l=j(C,e.__scopeScrollArea),o=e.orientation==="horizontal",c=X(()=>d("SCROLL_END"),100),[i,d]=Je("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return a.useEffect(()=>{if(i==="idle"){const h=window.setTimeout(()=>d("HIDE"),l.scrollHideDelay);return()=>window.clearTimeout(h)}},[i,l.scrollHideDelay,d]),a.useEffect(()=>{const h=l.viewport,f=o?"scrollLeft":"scrollTop";if(h){let p=h[f];const m=()=>{const b=h[f];p!==b&&(d("SCROLL"),c()),p=b};return h.addEventListener("scroll",m),()=>h.removeEventListener("scroll",m)}},[l.viewport,o,d,c]),t.jsx(Y,{present:n||i!=="hidden",children:t.jsx(Q,{"data-state":i==="hidden"?"hidden":"visible",...s,ref:r,onPointerEnter:A(e.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:A(e.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),ce=a.forwardRef((e,r)=>{const n=j(C,e.__scopeScrollArea),{forceMount:s,...l}=e,[o,c]=a.useState(!1),i=e.orientation==="horizontal",d=X(()=>{if(n.viewport){const h=n.viewport.offsetWidth<n.viewport.scrollWidth,f=n.viewport.offsetHeight<n.viewport.scrollHeight;c(i?h:f)}},10);return D(n.viewport,d),D(n.content,d),t.jsx(Y,{present:s||o,children:t.jsx(Q,{"data-state":o?"visible":"hidden",...l,ref:r})})}),Q=a.forwardRef((e,r)=>{const{orientation:n="vertical",...s}=e,l=j(C,e.__scopeScrollArea),o=a.useRef(null),c=a.useRef(0),[i,d]=a.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),h=ue(i.viewport,i.content),f={...s,sizes:i,onSizesChange:d,hasThumb:h>0&&h<1,onThumbChange:m=>o.current=m,onThumbPointerUp:()=>c.current=0,onThumbPointerDown:m=>c.current=m};function p(m,b){return st(m,c.current,i,b)}return n==="horizontal"?t.jsx(tt,{...f,ref:r,onThumbPositionChange:()=>{if(l.viewport&&o.current){const m=l.viewport.scrollLeft,b=re(m,i,l.dir);o.current.style.transform=`translate3d(${b}px, 0, 0)`}},onWheelScroll:m=>{l.viewport&&(l.viewport.scrollLeft=m)},onDragScroll:m=>{l.viewport&&(l.viewport.scrollLeft=p(m,l.dir))}}):n==="vertical"?t.jsx(rt,{...f,ref:r,onThumbPositionChange:()=>{if(l.viewport&&o.current){const m=l.viewport.scrollTop,b=re(m,i);o.current.style.transform=`translate3d(0, ${b}px, 0)`}},onWheelScroll:m=>{l.viewport&&(l.viewport.scrollTop=m)},onDragScroll:m=>{l.viewport&&(l.viewport.scrollTop=p(m))}}):null}),tt=a.forwardRef((e,r)=>{const{sizes:n,onSizesChange:s,...l}=e,o=j(C,e.__scopeScrollArea),[c,i]=a.useState(),d=a.useRef(null),h=O(r,d,o.onScrollbarXChange);return a.useEffect(()=>{d.current&&i(getComputedStyle(d.current))},[d]),t.jsx(de,{"data-orientation":"horizontal",...l,ref:h,sizes:n,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":$(n)+"px",...e.style},onThumbPointerDown:f=>e.onThumbPointerDown(f.x),onDragScroll:f=>e.onDragScroll(f.x),onWheelScroll:(f,p)=>{if(o.viewport){const m=o.viewport.scrollLeft+f.deltaX;e.onWheelScroll(m),pe(m,p)&&f.preventDefault()}},onResize:()=>{d.current&&o.viewport&&c&&s({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:V(c.paddingLeft),paddingEnd:V(c.paddingRight)}})}})}),rt=a.forwardRef((e,r)=>{const{sizes:n,onSizesChange:s,...l}=e,o=j(C,e.__scopeScrollArea),[c,i]=a.useState(),d=a.useRef(null),h=O(r,d,o.onScrollbarYChange);return a.useEffect(()=>{d.current&&i(getComputedStyle(d.current))},[d]),t.jsx(de,{"data-orientation":"vertical",...l,ref:h,sizes:n,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":$(n)+"px",...e.style},onThumbPointerDown:f=>e.onThumbPointerDown(f.y),onDragScroll:f=>e.onDragScroll(f.y),onWheelScroll:(f,p)=>{if(o.viewport){const m=o.viewport.scrollTop+f.deltaY;e.onWheelScroll(m),pe(m,p)&&f.preventDefault()}},onResize:()=>{d.current&&o.viewport&&c&&s({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:V(c.paddingTop),paddingEnd:V(c.paddingBottom)}})}})}),[ot,ie]=ne(C),de=a.forwardRef((e,r)=>{const{__scopeScrollArea:n,sizes:s,hasThumb:l,onThumbChange:o,onThumbPointerUp:c,onThumbPointerDown:i,onThumbPositionChange:d,onDragScroll:h,onWheelScroll:f,onResize:p,...m}=e,b=j(C,n),[S,P]=a.useState(null),z=O(r,x=>P(x)),N=a.useRef(null),_=a.useRef(""),I=b.viewport,k=s.content-s.viewport,L=R(f),E=R(d),u=X(p,10);function w(x){if(N.current){const v=x.clientX-N.current.left,y=x.clientY-N.current.top;h({x:v,y})}}return a.useEffect(()=>{const x=v=>{const y=v.target;(S==null?void 0:S.contains(y))&&L(v,k)};return document.addEventListener("wheel",x,{passive:!1}),()=>document.removeEventListener("wheel",x,{passive:!1})},[I,S,k,L]),a.useEffect(E,[s,E]),D(S,u),D(b.content,u),t.jsx(ot,{scope:n,scrollbar:S,hasThumb:l,onThumbChange:R(o),onThumbPointerUp:R(c),onThumbPositionChange:E,onThumbPointerDown:R(i),children:t.jsx(B.div,{...m,ref:z,style:{position:"absolute",...m.style},onPointerDown:A(e.onPointerDown,x=>{x.button===0&&(x.target.setPointerCapture(x.pointerId),N.current=S.getBoundingClientRect(),_.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",b.viewport&&(b.viewport.style.scrollBehavior="auto"),w(x))}),onPointerMove:A(e.onPointerMove,w),onPointerUp:A(e.onPointerUp,x=>{const v=x.target;v.hasPointerCapture(x.pointerId)&&v.releasePointerCapture(x.pointerId),document.body.style.webkitUserSelect=_.current,b.viewport&&(b.viewport.style.scrollBehavior=""),N.current=null})})})}),U="ScrollAreaThumb",he=a.forwardRef((e,r)=>{const{forceMount:n,...s}=e,l=ie(U,e.__scopeScrollArea);return t.jsx(Y,{present:n||l.hasThumb,children:t.jsx(nt,{ref:r,...s})})}),nt=a.forwardRef((e,r)=>{const{__scopeScrollArea:n,style:s,...l}=e,o=j(U,n),c=ie(U,n),{onThumbPositionChange:i}=c,d=O(r,p=>c.onThumbChange(p)),h=a.useRef(void 0),f=X(()=>{h.current&&(h.current(),h.current=void 0)},100);return a.useEffect(()=>{const p=o.viewport;if(p){const m=()=>{if(f(),!h.current){const b=at(p,i);h.current=b,i()}};return i(),p.addEventListener("scroll",m),()=>p.removeEventListener("scroll",m)}},[o.viewport,f,i]),t.jsx(B.div,{"data-state":c.hasThumb?"visible":"hidden",...l,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:A(e.onPointerDownCapture,p=>{const b=p.target.getBoundingClientRect(),S=p.clientX-b.left,P=p.clientY-b.top;c.onThumbPointerDown({x:S,y:P})}),onPointerUp:A(e.onPointerUp,c.onThumbPointerUp)})});he.displayName=U;var M="ScrollAreaCorner",fe=a.forwardRef((e,r)=>{const n=j(M,e.__scopeScrollArea),s=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&s?t.jsx(lt,{...e,ref:r}):null});fe.displayName=M;var lt=a.forwardRef((e,r)=>{const{__scopeScrollArea:n,...s}=e,l=j(M,n),[o,c]=a.useState(0),[i,d]=a.useState(0),h=!!(o&&i);return D(l.scrollbarX,()=>{var p;const f=((p=l.scrollbarX)==null?void 0:p.offsetHeight)||0;l.onCornerHeightChange(f),d(f)}),D(l.scrollbarY,()=>{var p;const f=((p=l.scrollbarY)==null?void 0:p.offsetWidth)||0;l.onCornerWidthChange(f),c(f)}),h?t.jsx(B.div,{...s,ref:r,style:{width:o,height:i,position:"absolute",right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function V(e){return e?parseInt(e,10):0}function ue(e,r){const n=e/r;return isNaN(n)?0:n}function $(e){const r=ue(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,s=(e.scrollbar.size-n)*r;return Math.max(s,18)}function st(e,r,n,s="ltr"){const l=$(n),o=l/2,c=r||o,i=l-c,d=n.scrollbar.paddingStart+c,h=n.scrollbar.size-n.scrollbar.paddingEnd-i,f=n.content-n.viewport,p=s==="ltr"?[0,f]:[f*-1,0];return me([d,h],p)(e)}function re(e,r,n="ltr"){const s=$(r),l=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,o=r.scrollbar.size-l,c=r.content-r.viewport,i=o-s,d=n==="ltr"?[0,c]:[c*-1,0],h=Ee(e,d);return me([0,c],[0,i])(h)}function me(e,r){return n=>{if(e[0]===e[1]||r[0]===r[1])return r[0];const s=(r[1]-r[0])/(e[1]-e[0]);return r[0]+s*(n-e[0])}}function pe(e,r){return e>0&&e<r}var at=(e,r=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},s=0;return function l(){const o={left:e.scrollLeft,top:e.scrollTop},c=n.left!==o.left,i=n.top!==o.top;(c||i)&&r(),n=o,s=window.requestAnimationFrame(l)}(),()=>window.cancelAnimationFrame(s)};function X(e,r){const n=R(e),s=a.useRef(0);return a.useEffect(()=>()=>window.clearTimeout(s.current),[]),a.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(n,r)},[n,r])}function D(e,r){const n=R(r);je(()=>{let s=0;if(e){const l=new ResizeObserver(()=>{cancelAnimationFrame(s),s=window.requestAnimationFrame(n)});return l.observe(e),()=>{window.cancelAnimationFrame(s),l.unobserve(e)}}},[e,n])}var xe=le,ct=ae,it=fe;const F=a.forwardRef(({className:e,children:r,...n},s)=>t.jsxs(xe,{ref:s,className:T("relative overflow-hidden",e),...n,children:[t.jsx(ct,{className:"h-full w-full rounded-[inherit]",children:r}),t.jsx(be,{}),t.jsx(it,{})]}));F.displayName=xe.displayName;const be=a.forwardRef(({className:e,orientation:r="vertical",...n},s)=>t.jsx(J,{ref:s,orientation:r,className:T("flex touch-none select-none transition-colors",r==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",r==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...n,children:t.jsx(he,{className:"relative flex-1 rounded-full bg-border"})}));be.displayName=J.displayName;function dt(e){const r={},n=new Date,s=new Date(n.getFullYear(),n.getMonth(),n.getDate()),l=new Date(s.getTime()-864e5),o=new Date(s.getTime()-7*864e5);for(const c of e){const i=c.date||c.created_at||"",d=i?new Date(i):new Date(0);let h="Older";d>=s?h="Today":d>=l?h="Yesterday":d>=o&&(h="This Week"),r[h]||(r[h]=[]),r[h].push(c)}return r}const ht={inbox:oe,sent:Ve,trash:_e,junk:Te,drafts:Fe};function ft(e){return e?e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`:""}function jt({mailboxes:e,activeMailbox:r,onSelectMailbox:n,messages:s,loadingMsgs:l,activeMessage:o,loadingBody:c,onSelectMessage:i,searchQuery:d="",onSearchChange:h,newMailCount:f=0,onClearMessage:p,attachmentBaseUrl:m}){const b=a.useRef(null),[S,P]=a.useState(null),z=a.useCallback(async u=>{if(!(!m||!r||!o)){P(u.id);try{const w=window.location.pathname.startsWith("/portal")?"portal_token":"admin_token",x=localStorage.getItem(w),y=`https://api.dasherhelp.com${m}/mailboxes/${r}/messages/${o.id}/attachments/${u.id}`,q=await fetch(y,{headers:x?{Authorization:`Bearer ${x}`}:{}});if(!q.ok)throw new Error("Download failed");const we=await q.blob(),ee=URL.createObjectURL(we),W=document.createElement("a");W.href=ee,W.download=u.filename||"attachment",document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(ee)}catch{}finally{P(null)}}},[m,r,o]),N=d?s.filter(u=>(u.subject||"").toLowerCase().includes(d.toLowerCase())||(u.from||u.sender||"").toLowerCase().includes(d.toLowerCase())):s,_=dt(N),I=["Today","Yesterday","This Week","Older"];a.useEffect(()=>{if(o!=null&&o.html&&b.current){const u=b.current.contentDocument;u&&(u.open(),u.write(`
          <html>
          <head><style>
            body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; font-size: 14px; color: #191919; margin: 16px; line-height: 1.6; }
            img { max-width: 100%; }
            a { color: #FF3008; }
          </style></head>
          <body>${o.html}</body>
          </html>
        `),u.close(),u.querySelectorAll("a").forEach(x=>{x.setAttribute("target","_blank"),x.setAttribute("rel","noopener noreferrer")}))}},[o]);const k=()=>t.jsx("div",{className:"p-3 space-y-2",children:Array.from({length:5}).map((u,w)=>t.jsxs("div",{className:"flex items-center gap-2.5",children:[t.jsx(g,{className:"h-4 w-4 rounded"}),t.jsx(g,{className:"h-4 flex-1"})]},w))}),L=()=>t.jsx("div",{className:"p-3 space-y-3",children:Array.from({length:6}).map((u,w)=>t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(g,{className:"h-3 w-24"}),t.jsx(g,{className:"h-4 w-full"}),t.jsx(g,{className:"h-3 w-16"})]},w))}),E=()=>t.jsxs("div",{className:"p-5 space-y-4",children:[t.jsx(g,{className:"h-6 w-3/4"}),t.jsx(g,{className:"h-4 w-1/2"}),t.jsx(g,{className:"h-3 w-1/3"}),t.jsx(K,{}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(g,{className:"h-4 w-full"}),t.jsx(g,{className:"h-4 w-full"}),t.jsx(g,{className:"h-4 w-5/6"}),t.jsx(g,{className:"h-4 w-2/3"})]})]});return t.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[t.jsxs("div",{className:"w-52 flex-shrink-0 hidden md:flex flex-col border-r border-dd-200 bg-white",children:[t.jsx("div",{className:"px-4 py-3 border-b border-dd-200",children:t.jsx("span",{className:"text-[11px] font-bold text-dd-600 uppercase tracking-wider",children:"Mailboxes"})}),e.length===0?t.jsx(k,{}):t.jsx(F,{className:"flex-1",children:t.jsx("div",{className:"py-1",children:e.map(u=>{const w=ht[u.name.toLowerCase()]||G,x=r===u.id;return t.jsxs("button",{onClick:()=>n(u.id),className:T("w-full text-left px-4 py-2.5 text-sm flex items-center gap-2.5 transition-colors",x?"bg-dd-red-light text-dd-red font-semibold":"text-dd-800 hover:bg-dd-50"),children:[t.jsx(w,{className:"h-4 w-4 flex-shrink-0"}),t.jsx("span",{className:"flex-1 truncate",children:u.name}),(u.unread??0)>0&&t.jsx(Re,{className:"bg-dd-red text-white border-0 text-[10px] font-bold px-1.5 py-0 min-w-[20px] justify-center hover:bg-dd-red",children:u.unread})]},u.id)})})})]}),t.jsx(K,{orientation:"vertical",className:"hidden md:block"}),t.jsxs("div",{className:T("w-full sm:w-80 flex-shrink-0 bg-white flex flex-col border-r border-dd-200",o?"hidden sm:flex":"flex"),children:[h&&t.jsx("div",{className:"px-3 py-2.5 border-b border-dd-200 flex-shrink-0",children:t.jsxs("div",{className:"relative",children:[t.jsx(ke,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-dd-500"}),t.jsx(ye,{type:"text",placeholder:"Search emails...",value:d,onChange:u=>h(u.target.value),className:"pl-9 h-8 bg-dd-100 border-transparent focus-visible:ring-dd-red/20 focus-visible:border-dd-red/30 text-sm"})]})}),f>0&&t.jsxs("div",{className:"px-4 py-2 bg-dd-red-light text-dd-red text-xs font-semibold border-b border-dd-200 flex items-center gap-2",children:[t.jsx(G,{className:"h-3.5 w-3.5"}),f," new email",f>1?"s":""]}),l?t.jsx(L,{}):N.length===0?t.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-dd-500 py-12",children:[t.jsx(oe,{className:"h-10 w-10 mb-3 text-dd-300"}),t.jsx("p",{className:"text-sm font-medium",children:"No messages"}),t.jsx("p",{className:"text-xs mt-1",children:d?"Try a different search term":"This mailbox is empty"})]}):t.jsx(F,{className:"flex-1",children:I.map(u=>{const w=_[u];return!w||w.length===0?null:t.jsxs("div",{children:[t.jsx("div",{className:"px-4 py-1.5 bg-dd-50 text-[10px] font-bold text-dd-600 uppercase tracking-wider sticky top-0 border-b border-dd-200",children:u}),w.map(x=>{const v=(o==null?void 0:o.id)===x.id,y=x.seen===!1;return t.jsxs("button",{onClick:()=>i(x.id),className:T("w-full text-left px-4 py-3 border-b border-dd-200 transition-colors group",v?"bg-dd-red-light":"hover:bg-dd-50",y&&"font-semibold"),children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[y&&t.jsx("span",{className:"h-2 w-2 rounded-full bg-dd-red flex-shrink-0"}),t.jsx("span",{className:"text-xs text-dd-600 truncate flex-1",children:x.from||x.sender||"Unknown"}),t.jsx(Ne,{className:"h-3.5 w-3.5 text-dd-400 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"})]}),t.jsx("div",{className:T("text-sm truncate mt-0.5",v?"text-dd-red":"text-dd-950"),children:x.subject||"(no subject)"}),t.jsx("div",{className:"text-[10px] text-dd-500 mt-0.5",children:x.date||x.created_at?new Date(x.date||x.created_at).toLocaleString():""})]},x.id)})]},u)})})]}),t.jsx("div",{className:T("flex-1 overflow-hidden flex flex-col bg-white",o?"flex":"hidden sm:flex"),children:c?t.jsx(E,{}):o?t.jsxs(t.Fragment,{children:[t.jsxs(Ce,{className:"p-5 pb-4 flex-shrink-0 space-y-0",children:[t.jsxs(te,{variant:"ghost",size:"sm",onClick:()=>p==null?void 0:p(),className:"sm:hidden self-start -ml-2 mb-2 text-dd-red hover:text-dd-red hover:bg-dd-red-light",children:[t.jsx(Ae,{className:"h-4 w-4 mr-1"}),"Back"]}),t.jsx(Pe,{className:"text-lg font-bold text-dd-950",children:o.subject}),t.jsxs("div",{className:"text-sm text-dd-700 mt-1.5 flex items-center gap-2",children:[t.jsx("span",{className:"font-medium",children:"From:"}),o.from||o.sender||"Unknown"]}),o.to&&t.jsxs("div",{className:"text-sm text-dd-600 mt-0.5 flex items-center gap-2",children:[t.jsx("span",{className:"font-medium",children:"To:"}),o.to]}),t.jsx("div",{className:"text-xs text-dd-500 mt-1",children:(o.date||o.created_at)&&new Date(o.date||o.created_at).toLocaleString()})]}),o.attachments&&o.attachments.length>0&&m&&t.jsxs("div",{className:"px-5 pb-3 flex-shrink-0",children:[t.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[t.jsx(He,{className:"h-3.5 w-3.5 text-dd-500"}),t.jsxs("span",{className:"text-xs font-medium text-dd-600",children:[o.attachments.length," attachment",o.attachments.length>1?"s":""]})]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:o.attachments.map(u=>t.jsxs(te,{variant:"outline",size:"sm",onClick:()=>z(u),disabled:S===u.id,className:"h-auto py-1.5 px-3 text-left gap-2 border-dd-200 hover:border-dd-red/30 hover:bg-dd-50",children:[t.jsx(Ie,{className:"h-4 w-4 text-dd-600 flex-shrink-0"}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("div",{className:"text-xs font-medium text-dd-950 truncate max-w-[180px]",children:u.filename}),u.size&&t.jsx("div",{className:"text-[10px] text-dd-500",children:ft(u.size)})]}),S===u.id?t.jsx(Le,{className:"h-3.5 w-3.5 text-dd-500 animate-spin flex-shrink-0"}):t.jsx(Oe,{className:"h-3.5 w-3.5 text-dd-500 flex-shrink-0"})]},u.id))})]}),t.jsx(K,{}),t.jsx("div",{className:"flex-1 overflow-hidden",children:o.html?t.jsx("iframe",{ref:b,title:"Email content",className:"w-full h-full border-0",sandbox:"allow-same-origin allow-popups allow-popups-to-escape-sandbox"}):t.jsx(F,{className:"h-full",children:t.jsx("div",{className:"p-5 whitespace-pre-wrap text-sm text-dd-800 leading-relaxed",children:o.text||"No content"})})})]}):t.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-dd-500",children:[t.jsx(G,{className:"h-12 w-12 mb-3 text-dd-300"}),t.jsx("p",{className:"text-sm font-medium",children:"Select a message to read"}),t.jsx("p",{className:"text-xs mt-1 text-dd-400",children:"Choose an email from the list"})]})})]})}export{jt as E,F as S};
